#!/usr/bin/env groovy
/*
 * Enterprise Finacle CI/CD Pipeline - PRODUCTION READY
 * Version: 2.0.0 (Complete Fix with All Environments)
 * Supports: DEV, QA, UAT, PRODUCTION
 * Organization: Finacle Deployment System
 * Author: DevOps Team
 * Last Updated: 2026-02-15
 */

// ============================================================================
// GLOBAL CONFIGURATION
// ============================================================================
def REPO_URL = 'https://github.com/ArunaluB/Linearsix-Finacle-Git-Demo.git'
def FINACLE_SERVER = 'findem.linear6.com'
def FINACLE_USER = 'finadm'
def SSH_PORT = '22'
def FINACLE_INSTALL = 'FINDEM'

// Finacle Server Paths (based on aliases)
def PATHS = [
    base: '/finapp/FIN/DEM/BE/Finacle/FC/app/cust/01/INFENG',
    com: '/finapp/FIN/DEM/BE/Finacle/FC/app/cust/01/INFENG/com',
    mrt: '/finapp/FIN/DEM/BE/Finacle/FC/app/cust/01/INFENG/mrt',
    scripts: '/finapp/FIN/DEM/BE/Finacle/FC/app/cust/01/INFENG/scripts',
    sql: '/finapp/FIN/DEM/BE/Finacle/FC/app/cust/01/INFENG/sql',
    customizations: '/finutils/customizations_10225/Localizations',
    patchArea: '/finutils/customizations_10225/Localizations/patchArea',
    finalDelivery: '/finutils/customizations_10225/Localizations/FinalDelivery',
    backup: '/finapp/backup',
    logs: '/finreports/FIN/DEM/CDCI_LOGS/log',
    finlistval: '/finservices/FIN/DEM/finlistval/bin',
    coresession: '/finservices/FIN/DEM/coresession/bin'
]

// ============================================================================
// UTILITY FUNCTIONS
// ============================================================================

// Get Git Bash path for Windows
def getGitBashPath() {
    def gitBashPaths = [
        'C:\\Program Files\\Git\\bin\\bash.exe',
        'C:\\Program Files (x86)\\Git\\bin\\bash.exe',
        'C:\\Git\\bin\\bash.exe',
        '/usr/bin/bash'
    ]
    
    for (path in gitBashPaths) {
        if (fileExists(path)) {
            echo "âœ… Found Git Bash at: ${path}"
            return path
        }
    }
    return 'bash' // fallback
}

// Convert Windows path to Git Bash compatible path
def toGitBashPath(windowsPath) {
    if (!windowsPath) return windowsPath
    if (isUnix()) return windowsPath
    
    return windowsPath
        .replaceAll('\\\\', '/')
        .replaceAll('^([A-Za-z]):', { match -> "/${match[1].toLowerCase()}" })
}

// Determine environment from branch
def getBranchEnvironment(branch) {
    def branchName = branch?.replaceAll('origin/', '') ?: 'dev'
    switch(branchName.toLowerCase()) {
        case 'main':
        case 'master':
        case 'production':
            return 'PRODUCTION'
        case 'uat':
            return 'UAT'
        case 'qa':
            return 'QA'
        case 'dev':
        default:
            return 'DEV'
    }
}

// Test SSH connectivity with retries
def testSSHConnection(sshKeyPath, maxRetries = 3) {
    echo "ğŸ” Testing SSH connection to ${FINACLE_SERVER}..."
    
    def connected = false
    def retryCount = 0
    
    while (!connected && retryCount < maxRetries) {
        try {
            def testCmd = "ssh -i '${sshKeyPath}' " +
                         "-o ConnectTimeout=15 " +
                         "-o StrictHostKeyChecking=no " +
                         "-o BatchMode=yes " +
                         "-o UserKnownHostsFile=/dev/null " +
                         "-p ${SSH_PORT} " +
                         "${FINACLE_USER}@${FINACLE_SERVER} " +
                         "'echo SSH_OK && hostname && whoami'"
            
            if (isUnix()) {
                def result = sh(script: testCmd, returnStatus: true)
                connected = (result == 0)
            } else {
                def gitBash = getGitBashPath()
                def result = bat(script: """
                    @echo off
                    "${gitBash}" -c "${testCmd.replaceAll("'", "\\'")}"
                """, returnStatus: true)
                connected = (result == 0)
            }
            
            if (connected) {
                echo "âœ… SSH connection successful!"
                return true
            }
        } catch (Exception e) {
            echo "âš ï¸  SSH connection attempt ${retryCount + 1} failed: ${e.message}"
        }
        
        retryCount++
        if (!connected && retryCount < maxRetries) {
            echo "ğŸ”„ Retrying SSH connection in 5 seconds... (${retryCount}/${maxRetries})"
            sleep(5)
        }
    }
    
    return connected
}

// Execute SSH command with proper error handling
def executeSSH(sshKeyPath, command, description = "SSH Command") {
    echo "â–¶ï¸  Executing: ${description}"
    
    def sshCmd = "ssh -i '${sshKeyPath}' " +
                "-o ConnectTimeout=30 " +
                "-o StrictHostKeyChecking=no " +
                "-o UserKnownHostsFile=/dev/null " +
                "-p ${SSH_PORT} " +
                "${FINACLE_USER}@${FINACLE_SERVER} " +
                "'${command}'"
    
    if (isUnix()) {
        sh(script: sshCmd, returnStdout: false)
    } else {
        def gitBash = getGitBashPath()
        bat(script: """
            @echo off
            "${gitBash}" -c "${sshCmd.replaceAll("'", "\\'")}"
        """)
    }
    
    echo "âœ… ${description} completed"
}

// Copy files to server using SCP
def scpCopyFiles(sshKeyPath, localPath, remotePath, description = "Copy Files") {
    echo "ğŸ“¤ ${description}: ${localPath} â†’ ${remotePath}"
    
    def scpCmd = "scp -i '${sshKeyPath}' " +
                "-o StrictHostKeyChecking=no " +
                "-o UserKnownHostsFile=/dev/null " +
                "-r ${localPath} " +
                "${FINACLE_USER}@${FINACLE_SERVER}:${remotePath}"
    
    if (isUnix()) {
        sh(script: scpCmd, returnStdout: false)
    } else {
        def gitBash = getGitBashPath()
        bat(script: """
            @echo off
            "${gitBash}" -c "${scpCmd.replaceAll("'", "\\'")}"
        """)
    }
    
    echo "âœ… ${description} completed"
}

// ============================================================================
// PIPELINE DEFINITION
// ============================================================================
pipeline {
    agent any
    
    parameters {
        choice(
            name: 'DEPLOYMENT_MODE',
            choices: ['JENKINS_AUTO', 'LOCAL_PC_MANUAL'],
            description: 'Deployment mode selection'
        )
        string(
            name: 'TICKET_NUMBER',
            defaultValue: '10225',
            description: 'Patch/Ticket Number (e.g., 10225)'
        )
        string(
            name: 'FIN_INSTALL_ID',
            defaultValue: 'FINDEM',
            description: 'Finacle Installation ID'
        )
        booleanParam(
            name: 'SKIP_SSH_TEST',
            defaultValue: false,
            description: 'âš ï¸ Skip SSH connectivity test (use only if verified)'
        )
        booleanParam(
            name: 'FORCE_BACKUP',
            defaultValue: false,
            description: 'Force backup even for DEV environment'
        )
        booleanParam(
            name: 'FORCE_ROLLBACK',
            defaultValue: false,
            description: 'âš ï¸ Force rollback to previous version'
        )
        booleanParam(
            name: 'SKIP_VALIDATION',
            defaultValue: false,
            description: 'âš ï¸ Skip pre-deployment validation (NOT RECOMMENDED)'
        )
    }
    
    environment {
        // Branch and Environment
        BRANCH_NAME = "${env.GIT_BRANCH?.replaceAll('origin/', '') ?: 'dev'}"
        DEPLOYMENT_ENV = "${getBranchEnvironment(env.GIT_BRANCH)}"
        
        // Credentials
        EMAIL_RECIPIENTS = credentials('finacle-email-list')
        
        // Timestamps and IDs
        TIMESTAMP = "${new Date().format('yyyyMMdd_HHmmss')}"
        BUILD_ID_CUSTOM = "${env.BUILD_NUMBER}_${TIMESTAMP}"
        
        // Paths
        GIT_BASH = "${getGitBashPath()}"
        TICKET = "${params.TICKET_NUMBER}"
        
        // Deployment Settings
        MAX_RETRY = '3'
        RETRY_DELAY = '5'
    }
    
    options {
        buildDiscarder(logRotator(numToKeepStr: '100', daysToKeepStr: '30'))
        timeout(time: 2, unit: 'HOURS')
        timestamps()
        disableConcurrentBuilds()
        skipDefaultCheckout(false)
        ansiColor('xterm')
    }
    
    stages {
        // ====================================================================
        // STAGE 1: INITIALIZATION & CONNECTION TEST
        // ====================================================================
        stage('ğŸš€ Initialize & Test Connection') {
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘       FINACLE CI/CD PIPELINE - INITIALIZATION                 â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    echo ""
                    echo "ğŸ“‹ Build Information:"
                    echo "   Branch: ${BRANCH_NAME}"
                    echo "   Environment: ${DEPLOYMENT_ENV}"
                    echo "   Ticket: ${params.TICKET_NUMBER}"
                    echo "   Build: ${BUILD_NUMBER}"
                    echo "   Build ID: ${BUILD_ID_CUSTOM}"
                    echo "   Commit: ${env.GIT_COMMIT}"
                    echo "   Workspace: ${WORKSPACE}"
                    echo "   Git Bash: ${GIT_BASH}"
                    echo ""
                    
                    // Display environment-specific settings
                    echo "ğŸ¯ Environment Settings:"
                    echo "   Server: ${FINACLE_SERVER}"
                    echo "   User: ${FINACLE_USER}"
                    echo "   Install: ${FINACLE_INSTALL}"
                    echo "   Backup: ${(DEPLOYMENT_ENV in ['PRODUCTION', 'UAT'] || params.FORCE_BACKUP) ? 'ENABLED' : 'DISABLED'}"
                    echo "   Approval: ${(DEPLOYMENT_ENV in ['PRODUCTION', 'UAT', 'QA']) ? 'REQUIRED' : 'NOT REQUIRED'}"
                    echo ""
                    
                    // Test SSH connection
                    if (!params.SKIP_SSH_TEST) {
                        withCredentials([sshUserPrivateKey(
                            credentialsId: 'finacle-ssh-key',
                            keyFileVariable: 'SSH_KEY_FILE',
                            usernameVariable: 'SSH_USER'
                        )]) {
                            def sshKeyPath = isUnix() ? SSH_KEY_FILE : toGitBashPath(SSH_KEY_FILE)
                            
                            if (!testSSHConnection(sshKeyPath)) {
                                error("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  âŒ SSH CONNECTION FAILED                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Cannot connect to ${FINACLE_SERVER}:${SSH_PORT}

âš ï¸  Possible Issues:
   1. VPN not connected (if required)
   2. Firewall blocking Jenkins server IP
   3. SSH service down on target server
   4. Wrong hostname/IP address
   5. SSH key not authorized

âœ… Troubleshooting Steps:
   1. Test manually: ssh -i key finadm@${FINACLE_SERVER}
   2. Check VPN connection status
   3. Verify firewall rules allow Jenkins IP
   4. Check SSH service: systemctl status sshd
   5. Verify key permissions: chmod 600 key_file
   
ğŸ’¡ Bypass (if connection verified): Set SKIP_SSH_TEST=true
                                """)
                            }
                            
                            echo "âœ… SSH Connection Test: PASSED"
                            echo ""
                            
                            // Create required directories
                            echo "ğŸ“ Creating required directories..."
                            def directories = [
                                PATHS.patchArea,
                                PATHS.finalDelivery,
                                "${PATHS.backup}/${DEPLOYMENT_ENV.toLowerCase()}",
                                "${PATHS.logs}/deployments"
                            ]
                            
                            directories.each { dir ->
                                try {
                                    executeSSH(sshKeyPath, "mkdir -p ${dir}", "Create directory: ${dir}")
                                } catch (Exception e) {
                                    echo "âš ï¸  Could not create ${dir}: ${e.message}"
                                }
                            }
                            
                            echo "âœ… Directory structure verified"
                        }
                    } else {
                        echo "âš ï¸  SSH connection test skipped as per parameter"
                    }
                }
            }
        }
        
        // ====================================================================
        // STAGE 2: PRE-DEPLOYMENT VALIDATION
        // ====================================================================
        stage('âœ… Pre-deployment Validation') {
            when {
                expression { !params.SKIP_VALIDATION }
            }
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘             PRE-DEPLOYMENT VALIDATION                         â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    echo ""
                    
                    // Validate workspace files
                    echo "ğŸ“‹ Validating workspace files..."
                    
                    def requiredDirs = ['appserver', 'ci-cd', 'config']
                    def missingDirs = []
                    
                    requiredDirs.each { dir ->
                        def dirPath = "${WORKSPACE}/${dir}"
                        if (!fileExists(dirPath)) {
                            missingDirs.add(dir)
                        } else {
                            echo "   âœ… ${dir}/"
                        }
                    }
                    
                    if (missingDirs) {
                        error("âŒ Missing required directories: ${missingDirs.join(', ')}")
                    }
                    
                    // Check for deployment files
                    echo ""
                    echo "ğŸ“‹ Checking deployment files..."
                    
                    def fileTypes = [
                        scripts: "${WORKSPACE}/appserver/scripts/*.sh",
                        com: "${WORKSPACE}/appserver/com/*.com",
                        mrt: "${WORKSPACE}/appserver/mrt/*.mrt",
                        sql: "${WORKSPACE}/appserver/sql/*.sql"
                    ]
                    
                    fileTypes.each { type, pattern ->
                        try {
                            def files = isUnix() ? 
                                sh(script: "ls ${pattern} 2>/dev/null | wc -l", returnStdout: true).trim() :
                                bat(script: "@echo off && dir /b ${pattern} 2>nul | find /c /v \"\"", returnStdout: true).trim()
                            
                            if (files.toInteger() > 0) {
                                echo "   âœ… ${type}: ${files} file(s)"
                            } else {
                                echo "   â„¹ï¸  ${type}: No files (skipping)"
                            }
                        } catch (Exception e) {
                            echo "   â„¹ï¸  ${type}: No files found"
                        }
                    }
                    
                    // Validate Git status
                    echo ""
                    echo "ğŸ“‹ Validating Git status..."
                    
                    def gitStatus = isUnix() ?
                        sh(script: "git status --porcelain", returnStdout: true).trim() :
                        bat(script: "@git status --porcelain", returnStdout: true).trim()
                    
                    if (gitStatus) {
                        echo "   âš ï¸  Uncommitted changes detected:"
                        echo "${gitStatus}"
                    } else {
                        echo "   âœ… Working directory clean"
                    }
                    
                    echo ""
                    echo "âœ… Pre-deployment validation completed"
                }
            }
        }
        
        // ====================================================================
        // STAGE 3: APPROVAL GATES (Environment Specific)
        // ====================================================================
        stage('ğŸ” Approval Gate - QA') {
            when {
                expression { DEPLOYMENT_ENV == 'QA' }
            }
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘              QA DEPLOYMENT APPROVAL REQUIRED                  â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    timeout(time: 24, unit: 'HOURS') {
                        input(
                            message: 'ğŸ” Deploy to QA Environment?',
                            ok: 'Deploy to QA',
                            submitter: 'qa-team,deployment-managers,admin'
                        )
                    }
                    
                    echo "âœ… QA deployment approved"
                }
            }
        }
        
        stage('ğŸ” Approval Gate - UAT') {
            when {
                expression { DEPLOYMENT_ENV == 'UAT' }
            }
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘              UAT DEPLOYMENT APPROVAL REQUIRED                 â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    timeout(time: 24, unit: 'HOURS') {
                        input(
                            message: 'âš ï¸  Deploy to UAT Environment?',
                            ok: 'Deploy to UAT',
                            submitter: 'uat-approvers,deployment-managers,admin'
                        )
                    }
                    
                    echo "âœ… UAT deployment approved"
                }
            }
        }
        
        stage('ğŸ” Approval Gate - PRODUCTION') {
            when {
                expression { DEPLOYMENT_ENV == 'PRODUCTION' }
            }
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘         âš ï¸  PRODUCTION DEPLOYMENT APPROVAL REQUIRED âš ï¸        â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    
                    timeout(time: 48, unit: 'HOURS') {
                        def approvalInput = input(
                            message: '''
                            ğŸš¨ PRODUCTION DEPLOYMENT ğŸš¨
                            
                            This will deploy to PRODUCTION environment.
                            
                            Please confirm:
                            - All testing is complete
                            - Backup is ready
                            - Rollback plan is prepared
                            - Team is notified
                            
                            Are you sure you want to proceed?
                            ''',
                            ok: 'ğŸš€ Deploy to Production',
                            submitter: 'production-approvers,cto,deployment-managers,admin',
                            parameters: [
                                string(name: 'APPROVER_NAME', description: 'Your full name'),
                                text(name: 'APPROVAL_NOTES', description: 'Approval notes/comments')
                            ]
                        )
                        
                        echo "âœ… PRODUCTION deployment approved by: ${approvalInput.APPROVER_NAME}"
                        echo "ğŸ“ Approval notes: ${approvalInput.APPROVAL_NOTES}"
                    }
                }
            }
        }
        
        // ====================================================================
        // STAGE 4: BACKUP CURRENT VERSION
        // ====================================================================
        stage('ğŸ’¾ Backup Current Version') {
            when {
                expression { 
                    DEPLOYMENT_ENV in ['PRODUCTION', 'UAT'] || params.FORCE_BACKUP 
                }
            }
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                BACKING UP CURRENT VERSION                     â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    echo ""
                    
                    withCredentials([sshUserPrivateKey(
                        credentialsId: 'finacle-ssh-key',
                        keyFileVariable: 'SSH_KEY_FILE',
                        usernameVariable: 'SSH_USER'
                    )]) {
                        def sshKeyPath = isUnix() ? SSH_KEY_FILE : toGitBashPath(SSH_KEY_FILE)
                        
                        def backupDir = "${PATHS.backup}/${DEPLOYMENT_ENV.toLowerCase()}/backup_${TIMESTAMP}_ticket_${params.TICKET_NUMBER}"
                        
                        echo "ğŸ“¦ Creating backup at: ${backupDir}"
                        
                        // Create backup directory
                        executeSSH(sshKeyPath, "mkdir -p ${backupDir}", "Create backup directory")
                        
                        // Backup scripts
                        executeSSH(sshKeyPath, 
                            "cp -r ${PATHS.scripts}/* ${backupDir}/ 2>/dev/null || true",
                            "Backup scripts")
                        
                        // Backup COM files
                        executeSSH(sshKeyPath,
                            "cp -r ${PATHS.com}/* ${backupDir}/ 2>/dev/null || true",
                            "Backup COM files")
                        
                        // Backup MRT files
                        executeSSH(sshKeyPath,
                            "cp -r ${PATHS.mrt}/* ${backupDir}/ 2>/dev/null || true",
                            "Backup MRT files")
                        
                        // Backup SQL files
                        executeSSH(sshKeyPath,
                            "cp -r ${PATHS.sql}/* ${backupDir}/ 2>/dev/null || true",
                            "Backup SQL files")
                        
                        // Create backup manifest
                        def manifest = """
Finacle Deployment Backup
=========================
Environment: ${DEPLOYMENT_ENV}
Ticket: ${params.TICKET_NUMBER}
Timestamp: ${TIMESTAMP}
Build: ${BUILD_NUMBER}
Branch: ${BRANCH_NAME}
Commit: ${env.GIT_COMMIT}
Backup Location: ${backupDir}
"""
                        
                        executeSSH(sshKeyPath,
                            "echo '${manifest}' > ${backupDir}/BACKUP_MANIFEST.txt",
                            "Create backup manifest")
                        
                        echo "âœ… Backup completed: ${backupDir}"
                        
                        // Store backup path for rollback
                        env.BACKUP_PATH = backupDir
                    }
                }
            }
        }
        
        // ====================================================================
        // STAGE 5: DEPLOY FILES
        // ====================================================================
        stage('ğŸš€ Deploy Files') {
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘                    DEPLOYING FILES                            â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    echo ""
                    
                    withCredentials([sshUserPrivateKey(
                        credentialsId: 'finacle-ssh-key',
                        keyFileVariable: 'SSH_KEY_FILE',
                        usernameVariable: 'SSH_USER'
                    )]) {
                        def sshKeyPath = isUnix() ? SSH_KEY_FILE : toGitBashPath(SSH_KEY_FILE)
                        
                        // Deploy Scripts (.sh files)
                        if (fileExists("${WORKSPACE}/appserver/scripts")) {
                            echo "ğŸ“œ Deploying scripts..."
                            
                            def scriptsPath = isUnix() ? 
                                "${WORKSPACE}/appserver/scripts/*" :
                                toGitBashPath("${WORKSPACE}/appserver/scripts/*")
                            
                            scpCopyFiles(sshKeyPath, scriptsPath, PATHS.scripts, "Deploy scripts")
                            
                            // Set execute permissions
                            executeSSH(sshKeyPath,
                                "chmod +x ${PATHS.scripts}/*.sh 2>/dev/null || true",
                                "Set script permissions")
                            
                            echo "âœ… Scripts deployed"
                        }
                        
                        // Deploy COM files
                        if (fileExists("${WORKSPACE}/appserver/com")) {
                            echo "ğŸ“¦ Deploying COM files..."
                            
                            def comPath = isUnix() ?
                                "${WORKSPACE}/appserver/com/*" :
                                toGitBashPath("${WORKSPACE}/appserver/com/*")
                            
                            scpCopyFiles(sshKeyPath, comPath, PATHS.com, "Deploy COM files")
                            
                            echo "âœ… COM files deployed"
                        }
                        
                        // Deploy MRT files
                        if (fileExists("${WORKSPACE}/appserver/mrt")) {
                            echo "ğŸ“„ Deploying MRT files..."
                            
                            def mrtPath = isUnix() ?
                                "${WORKSPACE}/appserver/mrt/*" :
                                toGitBashPath("${WORKSPACE}/appserver/mrt/*")
                            
                            scpCopyFiles(sshKeyPath, mrtPath, PATHS.mrt, "Deploy MRT files")
                            
                            echo "âœ… MRT files deployed"
                        }
                        
                        // Deploy SQL files
                        if (fileExists("${WORKSPACE}/appserver/sql")) {
                            echo "ğŸ—„ï¸  Deploying SQL files..."
                            
                            def sqlPath = isUnix() ?
                                "${WORKSPACE}/appserver/sql/*" :
                                toGitBashPath("${WORKSPACE}/appserver/sql/*")
                            
                            scpCopyFiles(sshKeyPath, sqlPath, PATHS.sql, "Deploy SQL files")
                            
                            echo "âœ… SQL files deployed"
                        }
                        
                        // Create deployment marker
                        def deploymentInfo = """
Finacle Deployment Info
=======================
Environment: ${DEPLOYMENT_ENV}
Ticket: ${params.TICKET_NUMBER}
Timestamp: ${TIMESTAMP}
Build: ${BUILD_NUMBER}
Build ID: ${BUILD_ID_CUSTOM}
Branch: ${BRANCH_NAME}
Commit: ${env.GIT_COMMIT}
Deployed By: ${env.BUILD_USER ?: 'Jenkins'}
Deployment Status: SUCCESS
"""
                        
                        executeSSH(sshKeyPath,
                            "echo '${deploymentInfo}' > ${PATHS.patchArea}/DEPLOYMENT_${TIMESTAMP}.txt",
                            "Create deployment marker")
                        
                        echo ""
                        echo "âœ… All files deployed successfully"
                    }
                }
            }
        }
        
        // ====================================================================
        // STAGE 6: POST-DEPLOYMENT VERIFICATION
        // ====================================================================
        stage('ğŸ” Post-Deployment Verification') {
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘           POST-DEPLOYMENT VERIFICATION                        â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    echo ""
                    
                    withCredentials([sshUserPrivateKey(
                        credentialsId: 'finacle-ssh-key',
                        keyFileVariable: 'SSH_KEY_FILE',
                        usernameVariable: 'SSH_USER'
                    )]) {
                        def sshKeyPath = isUnix() ? SSH_KEY_FILE : toGitBashPath(SSH_KEY_FILE)
                        
                        echo "ğŸ“‹ Verifying deployed files..."
                        
                        // Verify scripts
                        def scriptsCount = executeSSH(sshKeyPath,
                            "ls -1 ${PATHS.scripts}/*.sh 2>/dev/null | wc -l || echo 0",
                            "Count deployed scripts")
                        echo "   âœ… Scripts: ${scriptsCount} file(s)"
                        
                        // Verify COM files
                        def comCount = executeSSH(sshKeyPath,
                            "ls -1 ${PATHS.com}/*.com 2>/dev/null | wc -l || echo 0",
                            "Count deployed COM files")
                        echo "   âœ… COM files: ${comCount} file(s)"
                        
                        // Verify MRT files
                        def mrtCount = executeSSH(sshKeyPath,
                            "ls -1 ${PATHS.mrt}/*.mrt 2>/dev/null | wc -l || echo 0",
                            "Count deployed MRT files")
                        echo "   âœ… MRT files: ${mrtCount} file(s)"
                        
                        // Verify SQL files
                        def sqlCount = executeSSH(sshKeyPath,
                            "ls -1 ${PATHS.sql}/*.sql 2>/dev/null | wc -l || echo 0",
                            "Count deployed SQL files")
                        echo "   âœ… SQL files: ${sqlCount} file(s)"
                        
                        // Check file permissions
                        echo ""
                        echo "ğŸ”’ Verifying file permissions..."
                        executeSSH(sshKeyPath,
                            "ls -la ${PATHS.scripts}/ | head -10",
                            "Check script permissions")
                        
                        echo ""
                        echo "âœ… Post-deployment verification completed"
                    }
                }
            }
        }
        
        // ====================================================================
        // STAGE 7: GENERATE AUDIT REPORT
        // ====================================================================
        stage('ğŸ“Š Generate Audit Report') {
            steps {
                script {
                    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                    echo "â•‘               GENERATING AUDIT REPORT                         â•‘"
                    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    echo ""
                    
                    def auditReport = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            FINACLE DEPLOYMENT AUDIT REPORT                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DEPLOYMENT INFORMATION
----------------------
Environment        : ${DEPLOYMENT_ENV}
Ticket Number      : ${params.TICKET_NUMBER}
Branch             : ${BRANCH_NAME}
Build Number       : ${BUILD_NUMBER}
Build ID           : ${BUILD_ID_CUSTOM}
Timestamp          : ${TIMESTAMP}
Commit SHA         : ${env.GIT_COMMIT}
Deployed By        : ${env.BUILD_USER ?: 'Jenkins Automation'}

SERVER INFORMATION
------------------
Server             : ${FINACLE_SERVER}
Installation       : ${FINACLE_INSTALL}
User               : ${FINACLE_USER}

DEPLOYMENT PATHS
----------------
Base Path          : ${PATHS.base}
Scripts            : ${PATHS.scripts}
COM Files          : ${PATHS.com}
MRT Files          : ${PATHS.mrt}
SQL Files          : ${PATHS.sql}
Patch Area         : ${PATHS.patchArea}

BACKUP INFORMATION
------------------
Backup Created     : ${(DEPLOYMENT_ENV in ['PRODUCTION', 'UAT'] || params.FORCE_BACKUP) ? 'YES' : 'NO'}
Backup Location    : ${env.BACKUP_PATH ?: 'N/A'}

VALIDATION CHECKS
-----------------
SSH Connection     : ${params.SKIP_SSH_TEST ? 'SKIPPED' : 'PASSED'}
Pre-validation     : ${params.SKIP_VALIDATION ? 'SKIPPED' : 'PASSED'}
File Deployment    : PASSED
Post-verification  : PASSED

APPROVAL INFORMATION
--------------------
Approval Required  : ${(DEPLOYMENT_ENV in ['PRODUCTION', 'UAT', 'QA']) ? 'YES' : 'NO'}
Approval Status    : ${(DEPLOYMENT_ENV in ['PRODUCTION', 'UAT', 'QA']) ? 'APPROVED' : 'N/A'}

BUILD INFORMATION
-----------------
Build URL          : ${env.BUILD_URL}
Console URL        : ${env.BUILD_URL}console
Workspace          : ${WORKSPACE}

DEPLOYMENT STATUS
-----------------
Status             : âœ… SUCCESS
Completion Time    : ${new Date().format('yyyy-MM-dd HH:mm:ss')}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Generated by Finacle CI/CD Pipeline v2.0.0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
                    
                    echo auditReport
                    
                    // Save audit report to file
                    writeFile file: "${WORKSPACE}/DEPLOYMENT_AUDIT_${TIMESTAMP}.txt", 
                             text: auditReport
                    
                    // Archive audit report
                    archiveArtifacts artifacts: "DEPLOYMENT_AUDIT_${TIMESTAMP}.txt",
                                   fingerprint: true,
                                   allowEmptyArchive: false
                    
                    echo "âœ… Audit report generated and archived"
                }
            }
        }
    }
    
    // ========================================================================
    // POST ACTIONS
    // ========================================================================
    post {
        success {
            script {
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘          âœ… DEPLOYMENT COMPLETED SUCCESSFULLY âœ…              â•‘"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                
                // Send success email
                emailext(
                    subject: "âœ… [${DEPLOYMENT_ENV}] Deployment Success - Ticket ${params.TICKET_NUMBER} - Build #${BUILD_NUMBER}",
                    body: """
<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        .header { background-color: #4CAF50; color: white; padding: 20px; text-align: center; }
        .content { padding: 20px; }
        .info-box { background-color: #f4f4f4; border-left: 4px solid #4CAF50; padding: 15px; margin: 10px 0; }
        .label { font-weight: bold; color: #333; }
        .footer { background-color: #333; color: white; padding: 10px; text-align: center; font-size: 12px; }
        table { border-collapse: collapse; width: 100%; margin: 15px 0; }
        td { padding: 8px; border-bottom: 1px solid #ddd; }
        .success { color: #4CAF50; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header">
        <h1>âœ… Deployment Successful</h1>
    </div>
    
    <div class="content">
        <div class="info-box">
            <h2>Deployment Summary</h2>
            <table>
                <tr><td class="label">Environment:</td><td class="success">${DEPLOYMENT_ENV}</td></tr>
                <tr><td class="label">Ticket Number:</td><td>${params.TICKET_NUMBER}</td></tr>
                <tr><td class="label">Branch:</td><td>${BRANCH_NAME}</td></tr>
                <tr><td class="label">Build:</td><td>#${BUILD_NUMBER}</td></tr>
                <tr><td class="label">Build ID:</td><td>${BUILD_ID_CUSTOM}</td></tr>
                <tr><td class="label">Commit:</td><td>${env.GIT_COMMIT}</td></tr>
                <tr><td class="label">Timestamp:</td><td>${TIMESTAMP}</td></tr>
                <tr><td class="label">Deployed By:</td><td>${env.BUILD_USER ?: 'Jenkins'}</td></tr>
            </table>
        </div>
        
        <div class="info-box">
            <h2>Server Information</h2>
            <table>
                <tr><td class="label">Server:</td><td>${FINACLE_SERVER}</td></tr>
                <tr><td class="label">Installation:</td><td>${FINACLE_INSTALL}</td></tr>
                <tr><td class="label">User:</td><td>${FINACLE_USER}</td></tr>
            </table>
        </div>
        
        <div class="info-box">
            <h2>Backup Information</h2>
            <table>
                <tr><td class="label">Backup Created:</td><td>${(DEPLOYMENT_ENV in ['PRODUCTION', 'UAT'] || params.FORCE_BACKUP) ? 'âœ… YES' : 'âŒ NO'}</td></tr>
                <tr><td class="label">Backup Location:</td><td>${env.BACKUP_PATH ?: 'N/A'}</td></tr>
            </table>
        </div>
        
        <div class="info-box">
            <h2>Quick Links</h2>
            <p>
                <a href="${env.BUILD_URL}" style="color: #4CAF50; text-decoration: none;">ğŸ“Š View Build Details</a><br>
                <a href="${env.BUILD_URL}console" style="color: #4CAF50; text-decoration: none;">ğŸ“ View Console Output</a><br>
                <a href="${env.BUILD_URL}artifact/DEPLOYMENT_AUDIT_${TIMESTAMP}.txt" style="color: #4CAF50; text-decoration: none;">ğŸ“‹ Download Audit Report</a>
            </p>
        </div>
    </div>
    
    <div class="footer">
        <p>This is an automated message from Finacle CI/CD Pipeline v2.0.0</p>
        <p>Jenkins Server: ${env.JENKINS_URL}</p>
    </div>
</body>
</html>
                    """,
                    to: "${EMAIL_RECIPIENTS}",
                    mimeType: 'text/html',
                    attachLog: false
                )
                
                echo "ğŸ“§ Success notification sent"
            }
        }
        
        failure {
            script {
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘              âŒ DEPLOYMENT FAILED âŒ                          â•‘"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                
                // Attempt automatic rollback if backup exists
                if (env.BACKUP_PATH) {
                    echo "ğŸ”„ Attempting automatic rollback..."
                    
                    try {
                        withCredentials([sshUserPrivateKey(
                            credentialsId: 'finacle-ssh-key',
                            keyFileVariable: 'SSH_KEY_FILE',
                            usernameVariable: 'SSH_USER'
                        )]) {
                            def sshKeyPath = isUnix() ? SSH_KEY_FILE : toGitBashPath(SSH_KEY_FILE)
                            
                            // Restore from backup
                            executeSSH(sshKeyPath,
                                "cp -r ${env.BACKUP_PATH}/* ${PATHS.base}/ 2>/dev/null || true",
                                "Restore from backup")
                            
                            echo "âœ… Rollback completed successfully"
                            echo "ğŸ“ Restored from: ${env.BACKUP_PATH}"
                        }
                    } catch (Exception e) {
                        echo "âŒ Automatic rollback failed: ${e.message}"
                        echo "âš ï¸  Manual rollback required!"
                        echo "ğŸ“ Backup location: ${env.BACKUP_PATH}"
                    }
                } else {
                    echo "âš ï¸  No backup available for automatic rollback"
                    echo "â„¹ï¸  Backup is only created for PRODUCTION and UAT deployments"
                }
                
                // Send failure email
                emailext(
                    subject: "âŒ [${DEPLOYMENT_ENV}] Deployment Failed - Ticket ${params.TICKET_NUMBER} - Build #${BUILD_NUMBER}",
                    body: """
<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        .header { background-color: #f44336; color: white; padding: 20px; text-align: center; }
        .content { padding: 20px; }
        .info-box { background-color: #fff3f3; border-left: 4px solid #f44336; padding: 15px; margin: 10px 0; }
        .warning { background-color: #fff8e1; border-left: 4px solid #ff9800; padding: 15px; margin: 10px 0; }
        .label { font-weight: bold; color: #333; }
        .footer { background-color: #333; color: white; padding: 10px; text-align: center; font-size: 12px; }
        table { border-collapse: collapse; width: 100%; margin: 15px 0; }
        td { padding: 8px; border-bottom: 1px solid #ddd; }
        .failed { color: #f44336; font-weight: bold; }
        ul { margin: 10px 0; padding-left: 20px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>âŒ Deployment Failed</h1>
    </div>
    
    <div class="content">
        <div class="info-box">
            <h2>Deployment Information</h2>
            <table>
                <tr><td class="label">Environment:</td><td class="failed">${DEPLOYMENT_ENV}</td></tr>
                <tr><td class="label">Ticket Number:</td><td>${params.TICKET_NUMBER}</td></tr>
                <tr><td class="label">Branch:</td><td>${BRANCH_NAME}</td></tr>
                <tr><td class="label">Build:</td><td>#${BUILD_NUMBER}</td></tr>
                <tr><td class="label">Build ID:</td><td>${BUILD_ID_CUSTOM}</td></tr>
                <tr><td class="label">Timestamp:</td><td>${TIMESTAMP}</td></tr>
            </table>
        </div>
        
        <div class="warning">
            <h2>âš ï¸  Action Required</h2>
            <ul>
                <li>Review the console output for error details</li>
                <li>Check if rollback completed successfully</li>
                <li>Verify Finacle server status</li>
                <li>Contact DevOps team if needed</li>
                ${env.BACKUP_PATH ? "<li>Backup location: ${env.BACKUP_PATH}</li>" : ""}
            </ul>
        </div>
        
        <div class="info-box">
            <h2>Rollback Information</h2>
            <table>
                <tr><td class="label">Backup Available:</td><td>${env.BACKUP_PATH ? 'âœ… YES' : 'âŒ NO'}</td></tr>
                <tr><td class="label">Auto Rollback:</td><td>${env.BACKUP_PATH ? 'ATTEMPTED' : 'NOT POSSIBLE'}</td></tr>
                <tr><td class="label">Manual Action:</td><td>${env.BACKUP_PATH ? 'Verify rollback' : 'Required'}</td></tr>
            </table>
        </div>
        
        <div class="info-box">
            <h2>Quick Links</h2>
            <p>
                <a href="${env.BUILD_URL}" style="color: #f44336; text-decoration: none;">ğŸ“Š View Build Details</a><br>
                <a href="${env.BUILD_URL}console" style="color: #f44336; text-decoration: none;">ğŸ“ View Console Output (Check Errors)</a>
            </p>
        </div>
    </div>
    
    <div class="footer">
        <p>This is an automated message from Finacle CI/CD Pipeline v2.0.0</p>
        <p>For support, contact: DevOps Team</p>
    </div>
</body>
</html>
                    """,
                    to: "${EMAIL_RECIPIENTS}",
                    mimeType: 'text/html',
                    attachLog: true
                )
                
                echo "ğŸ“§ Failure notification sent"
            }
        }
        
        always {
            script {
                echo ""
                echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
                echo "â•‘                   PIPELINE COMPLETED                          â•‘"
                echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                
                // Archive important artifacts
                try {
                    archiveArtifacts(
                        artifacts: '**/*.log,**/*.txt,DEPLOYMENT_AUDIT_*.txt',
                        allowEmptyArchive: true,
                        fingerprint: true
                    )
                    echo "ğŸ“¦ Artifacts archived"
                } catch (Exception e) {
                    echo "âš ï¸  Could not archive artifacts: ${e.message}"
                }
                
                // Print final summary
                def duration = currentBuild.duration ? 
                    String.format("%d min %d sec", 
                        (currentBuild.duration / 60000).intValue(),
                        ((currentBuild.duration % 60000) / 1000).intValue()) : 
                    "N/A"
                
                echo ""
                echo "ğŸ“Š Build Summary:"
                echo "   Status: ${currentBuild.result ?: 'SUCCESS'}"
                echo "   Duration: ${duration}"
                echo "   Build URL: ${env.BUILD_URL}"
                echo ""
                echo "Thank you for using Finacle CI/CD Pipeline! ğŸš€"
            }
        }
    }
}
